<?xml version="1.0" encoding="utf-8" ?>
<c:Screen xmlns:c="BitMobile.Controls" xmlns:s="BitMobile.ValueStack" StyleSheet="Visit_SKUs.css">

  <s:Push Id="order" Value="$workflow.order"></s:Push>
  <s:Push Id="search" Value="$param2"></s:Push>

  <s:Push Id="groups" Value="$Facade.GetSKUGroups($search)"></s:Push>

  <c:DockLayout>

    <c:HorizontalLayout CssClass="margin_top"></c:HorizontalLayout>
    <c:HorizontalLine/>

    <c:HorizontalLayout CssClass="bottom_btn" OnEvent="Forward" OnClickAction="$Workflow.DoForward($workflow.outlet)">
      <c:TextView Text="#ready#"></c:TextView>
    </c:HorizontalLayout>
    <c:HorizontalLine/>

    <c:HorizontalLayout CssClass="search">
      <c:DockLayout >
        <c:Image />
        <c:EditText Id="edtSearch" Text="$search"></c:EditText>
      </c:DockLayout>
      <c:Button Id="btnSearch" Text="#search#" OnClickAction="$Facade.ClearAndRefresh($param1,$edtSearch.Text)"></c:Button>
    </c:HorizontalLayout>
    <c:HorizontalLine/>

    <c:DockLayout CssClass="parameter_grid" OnClickAction="$Workflow.DoAction(SetFilter)">
      <c:TextView Text="#filter#"></c:TextView>
      <c:TextView Text="param, param" CssClass="action_and_value"></c:TextView>
      <c:Image></c:Image>
    </c:DockLayout>



    
    <c:ScrollView Id="grScrollView" CssClass="80_partial_scroll">

      <s:Iterator Id="group" Value="$groups">
        <s:Push Id="skusByGroup" Value="$Facade.GetSKUs($search,$group.Id,$order.PriceList)"></s:Push>

        <s:If Test="$groupIsNotEmpty">
          <s:Push Id="groupPath" Value="$Facade.GetGroupPath($group)"></s:Push>
          <c:HorizontalLayout CssClass="caption_grid">
            <c:TextView Text = "{$groupPath}{ } /{ } {$group.Description}"></c:TextView>
          </c:HorizontalLayout>
          <c:HorizontalLine/>

          <s:Iterator Id="sku" Value="$skusByGroup">
            <s:Push Id="skuObj" Value="$sku.SKUAsObject"></s:Push>
            <c:HorizontalLayout OnClickAction="$Workflow.DoAction(SelectSKU, $skuObj, $sku.Price)" CssClass="grid">
              <c:VerticalLayout>
                <c:TextView Text="$skuObj.Description" CssClass="main_row"></c:TextView>
                <c:TextView Text="{$skuObj.CommonStock} {$skuObj.BaseUnitAsObject.Description}; {$sku.Price}; #brand#: {$skuObj.BrandAsObject.Description}" CssClass="description_row"></c:TextView>
              </c:VerticalLayout>
              <c:Image/>
            </c:HorizontalLayout>
            <c:HorizontalLine/>

          </s:Iterator>

        </s:If>

      </s:Iterator>

    </c:ScrollView>

  </c:DockLayout>

</c:Screen>